/*======================================

Created by Rafal Bielecki 2023-04-03

		===Wordle Solver===

======================================*/

----------------------------------------------------
----Table with all available 5-letter english words
----------------------------------------------------

DROP TABLE IF EXISTS _tb_wordle_all_words
DROP TABLE IF EXISTS _tb_wordle_base

--staging - loading source data
CREATE TABLE _tb_wordle_all_words
(
ID INT IDENTITY(1,1) NOT NULL
,word VARCHAR(5) NOT NULL
CONSTRAINT [PK_tb_wordle_all_words] PRIMARY KEY CLUSTERED (ID)
)
ON [PRIMARY]
GO

INSERT INTO _tb_wordle_all_words VALUES
('aback'),('abaft'),('abase'),('abash'),('abate'),('abbey'),('abbot'),('abeam'),('abhor'),('abide'),('abode'),('abort'),('about'),('above'),('abuse'),('abuzz'),('abyss'),('achoo'),('acorn'),('acrid'),('actor'),('acute'),('adage'),('adapt'),('adder'),('addle'),('adept'),('adieu'),('adios'),('adman'),('admit'),('admix'),('adobe'),('adopt'),('adore'),('adorn'),('adult'),('aegis'),('aerie'),('affix'),('afire'),('afoot'),('afoul'),('after'),('again'),('agape'),('agate'),('agave'),('agent'),('agile'),('aging'),('aglow'),('agony'),('agree'),('ahead'),('aisle'),('aitch'),('alack'),('alarm'),('album'),('alder'),('alert'),('algal'),('alias'),('alibi'),('alien'),('align'),('alike'),('aline'),('alive'),('alkyd'),('allay'),('alley'),('allot'),('allow'),('alloy'),('aloft'),('aloha'),('alone'),('along'),('aloof'),('aloud'),('alpha'),('altar'),('alter'),('altho'),('amass'),('amaze'),('amber'),('amble'),('ameba'),('amend'),('amide'),('amigo'),('amiss'),('amity'),('among'),('amour'),('ample'),('amply'),('ampul'),('amuck'),('amuse'),('anent'),('angel'),('anger'),('angle'),('angry'),('angst'),('anime'),('anion'),('anise'),('ankle'),('annex'),('annoy'),('annul'),('anode'),('antic'),('antsy'),('anvil'),('aorta'),('apace'),('apart'),('aphid'),('apish'),('appal'),('apple'),('apply'),('apron'),('aptly'),('arbor'),('ardor'),('areal'),('arena'),('argon'),('argot'),('argue'),('arise'),('armor'),('aroma'),('arras'),('array'),('arrow'),('arson'),('artsy'),('ascot'),('ashen'),('aside'),('askew'),('aspen'),('aspic'),('assay'),('asset'),('aster'),('astir'),('atilt'),('atlas'),('atoll'),('atone'),('attar'),('attic'),('audio'),('audit'),('auger'),('aught'),('augur'),('aunty'),('aural'),('auxin'),('avail'),('avast'),('avert'),('avian'),('avoid'),('await'),('awake'),('award'),('aware'),('awash'),('awful'),('axial'),('axiom'),('azure'),('babel'),('bacon'),('baddy'),('badge'),('badly'),('bagel'),('baggy'),('bairn'),('baize'),('baker'),('baler'),('balky'),('balmy'),('balsa'),('banal'),('bandy'),('banjo'),('banns'),('barge'),('baron'),('barre'),('basal'),('basic'),('basil'),('basin'),('basis'),('basso'),('baste'),('batch'),('bathe'),('batik'),('baton'),('batty'),('baulk'),('bawdy'),('bayou'),('beach'),('beady'),('beard'),('beast'),('beaut'),('bebop'),('bedim'),('beech'),('beefy'),('beery'),('befit'),('befog'),('beget'),('begin'),('begum'),('beige'),('being'),('belay'),('belch'),('belie'),('belle'),('belly'),('below'),('bench'),('beret'),('berry'),('berth'),('beryl'),('beset'),('besom'),('besot'),('betel'),('bevel'),('bezel'),('bible'),('bicep'),('biddy'),('bidet'),('bight'),('bigot'),('bijou'),('biker'),('bilge'),('billy'),('bimbo'),('binge'),('bingo'),('biped'),('birch'),('birth'),('bison'),('bitch'),('biter'),('bitty'),('black'),('blade'),('blahs'),('blame'),('bland'),('blank'),('blare'),('blase'),('blast'),('blaze'),('bleak'),('blear'),('bleat'),('bleed'),('bleep'),('blend'),('bless'),('blimp'),('blind'),('bling'),('blini'),('blink'),('bliss'),('blitz'),('bloat'),('block'),('bloke'),('blond'),('blood'),('bloom'),('bloop'),('blowy'),('bluet'),('bluff'),('blunt'),('blurb'),('blurt'),('blush'),('board'),('boast'),('bobby'),('bocce'),('bocci'),('boffo'),('bogey'),('boggy'),('bogie'),('bogus'),('bolus'),('boner'),('boney'),('bongo'),('bonny'),('bonus'),('booby'),('boost'),('booth'),('booty'),('booze'),('boozy'),('borax'),('borer'),('boron'),('bosom'),('bossy'),('bosun'),('botch'),('bough'),('bound'),('bowel'),('bower'),('boxer'),('brace'),('bract'),('braid'),('brain'),('brake'),('brand'),('brash'),('brass'),('brave'),('bravo'),('brawl'),('brawn'),('braze'),('bread'),('break'),('bream'),('breed'),('breve'),('briar'),('bribe'),('brick'),('bride'),('brief'),('brier'),('brine'),('bring'),('brink'),('briny'),('brisk'),('broad'),('broil'),('broke'),('bronc'),('brood'),('brook'),('broom'),('broth'),('brown'),('bruin'),('bruit'),('brunt'),('brush'),('brusk'),('brute'),('buddy'),('budge'),('buggy'),('bugle'),('build'),('bulge'),('bulgy'),('bulky'),('bully'),('bumpy'),('bunch'),('bunco'),('bunko'),('bunny'),('burbs'),('burgh'),('burly'),('burka'),('burqa'),('burro'),('bursa'),('burst'),('busby'),('bushy'),('busty'),('butch'),('butte'),('buxom'),('buyer'),('bylaw'),('byway'),('cabal'),('cabby'),('cabin'),('cable'),('cacao'),('cache'),('caddy'),('cadet'),('cadge'),('cadre'),('cagey'),('cairn'),('calif'),('calla'),('calve'),('calyx'),('camel'),('cameo'),('campy'),('canal'),('candy'),('caner'),('canny'),('canoe'),('canon'),('canto'),('caped'),('caper'),('capon'),('carat'),('carbs'),('carer'),('caret'),('cargo'),('carny'),('carob'),('carol'),('carom'),('carry'),('carve'),('caste'),('catch'),('cater'),('catty'),('caulk'),('cause'),('cavil'),('cease'),('cecal'),('cecum'),('cedar'),('ceder'),('cello'),('chafe'),('chaff'),('chain'),('chair'),('chalk'),('champ'),('chant'),('chaos'),('chard'),('charm'),('chart'),('chary'),('chase'),('chasm'),('cheap'),('cheat'),('check'),('cheek'),('cheep'),('cheer'),('chemo'),('chert'),('chess'),('chest'),('chewy'),('chick'),('chide'),('chief'),('child'),('chile'),('chili'),('chill'),('chime'),('chimp'),('china'),('chine'),('chink'),('chino'),('chirp'),('chive'),('chock'),('choir'),('choke'),('chomp'),('chord'),('chore'),('chose'),('chuck'),('chump'),('chunk'),('churl'),('churn'),('chute'),('chyme'),('cider'),('cigar'),('cinch'),('circa'),('civet'),('civic'),('civil'),('clack'),('claim'),('clamp'),('clang'),('clank'),('clash'),('clasp'),('class'),('clean'),('clear'),('cleat'),('cleft'),('clerk'),('click'),('cliff'),('climb'),('clime'),('cling'),('clink'),('cloak'),('clock'),('clomp'),('clone'),('clonk'),('close'),('cloth'),('cloud'),('clout'),('clove'),('clown'),('cluck'),('clump'),('clunk'),('coach'),('coast'),('cobra'),('cocky'),('cocoa'),('coder'),('codex'),('colic'),('colon'),('color'),('combo'),('comer'),('comet'),('comfy'),('comic'),('comma'),('conch'),('condo'),('coney'),('conga'),('conic'),('cooky'),('copay'),('copra'),('copse'),('coral'),('corer'),('corgi'),('corny'),('corps'),('couch'),('cough'),('count'),('coupe'),('court'),('coven'),('cover'),('covet'),('covey'),('cower'),('coyly'),('coypu'),('cozen'),('crack'),('craft'),('cramp'),('crane'),('crank'),('crape'),('craps'),('crash'),('crass'),('crate'),('crave'),('crawl'),('craze'),('crazy'),('creak'),('cream'),('credo'),('creed'),('creek'),('creel'),('creep'),('creme'),('crepe'),('cress'),('crest'),('crick'),('crier'),('crime'),('crimp'),('crisp'),('croak'),('crock'),('crone'),('crony'),('crook'),('croon'),('cross'),('croup'),('crowd'),('crown'),('crude'),('cruel'),('cruet'),('crumb'),('cruse'),('crush'),('crust'),('crypt'),('cuber'),('cubic'),('cubit'),('cumin'),('cupid'),('curer'),('curia'),('curie'),('curio'),('curly'),('curry'),('curse'),('curve'),('curvy'),('cushy'),('cutie'),('cutup'),('cycle'),('cyder'),('cynic'),('dacha'),('daddy'),('daffy'),('daily'),('dairy'),('daisy'),('dally'),('dance'),('dandy'),('darer'),('dater'),('datum'),('daunt'),('davit'),('deary'),('death'),('debar'),('debit'),('debug'),('debut'),('decaf'),('decal'),('decay'),('decor'),('decoy'),('decry'),('defer'),('defog'),('degas'),('deice'),('deify'),('deign'),('deism'),('deist'),('deity'),('delay'),('delft'),('delta'),('delve'),('demon'),('demur'),('denim'),('dense'),('depot'),('depth'),('derby'),('deter'),('detox'),('deuce'),('devil'),('dhoti'),('diary'),('dicey'),('dicky'),('digit'),('dilly'),('dimly'),('dinar'),('diner'),('dingo'),('dingy'),('dinky'),('diode'),('dippy'),('dirge'),('dirty'),('disco'),('ditch'),('ditsy'),('ditto'),('ditty'),('ditzy'),('divan'),('diver'),('divot'),('divvy'),('dizzy'),('djinn'),('dodge'),('doggy'),('dogie'),('dogma'),('doily'),('doing'),('dolly'),('dolor'),('donor'),('donut'),('doper'),('dopey'),('dorky'),('doter'),('dotty'),('doubt'),('dough'),('douse'),('dowdy'),('dowel'),('dower'),('downy'),('dowry'),('dowse'),('doyen'),('dozen'),('draft'),('drain'),('drake'),('drama'),('drape'),('drawl'),('dread'),('dream'),('drear'),('dregs'),('dress'),('drier'),('drift'),('drill'),('drily'),('drink'),('drive'),('droll'),('drone'),('drool'),('droop'),('dross'),('drove'),('drown'),('druid'),('drunk'),('drupe'),('dryad'),('dryer'),('dryly'),('ducal'),('ducat'),('duchy'),('ducky'),('dully'),('dummy'),('dumpy'),('dunce'),('dunno'),('duper'),('duple'),('durum'),('dusky'),('dusty'),('dutch'),('duvet'),('dwarf'),('dweeb'),('dwell'),('dying'),('eager'),('eagle'),('eared'),('early'),('earth'),('easel'),('eater'),('ebony'),('eclat'),('edema'),('edger'),('edict'),('edify'),('educe'),('eerie'),('egret'),('eider'),('eight'),('eject'),('eland'),('elate'),('elbow'),('elder'),('elect'),('elegy'),('elfin'),('elide'),('elite'),('elope'),('elude'),('elver'),('email'),('embed'),('ember'),('emcee'),('emend'),('emery'),('emoji'),('emote'),('empty'),('enact'),('endow'),('endue'),('enema'),('enemy'),('enjoy'),('ennui'),('enrol'),('ensue'),('enter'),('entry'),('enure'),('envoy'),('epoch'),('epoxy'),('equal'),('equip'),('erase'),('erect'),('ergot'),('erode'),('error'),('eruct'),('erupt'),('essay'),('ester'),('ether'),('ethic')
INSERT INTO _tb_wordle_all_words VALUES
('ethos'),('ethyl'),('etude'),('evade'),('event'),('every'),('evict'),('evoke'),('exact'),('exalt'),('excel'),('exert'),('exile'),('exist'),('expel'),('extol'),('extra'),('exude'),('exult'),('exurb'),('eyrie'),('fable'),('facet'),('faery'),('fagot'),('faint'),('fairy'),('faith'),('faker'),('fakir'),('false'),('famed'),('fancy'),('fanny'),('farad'),('farce'),('fatal'),('fatty'),('fatwa'),('fault'),('fauna'),('favor'),('feast'),('fecal'),('feces'),('feign'),('feint'),('felon'),('femur'),('fence'),('feral'),('ferny'),('ferry'),('fetal'),('fetch'),('fetid'),('fetus'),('fever'),('fiber'),('fibre'),('fiche'),('fichu'),('ficus'),('field'),('fiend'),('fiery'),('fifer'),('fifth'),('fifty'),('fight'),('filch'),('filer'),('filet'),('filly'),('filmy'),('filth'),('final'),('finch'),('finis'),('finny'),('fiord'),('firer'),('first'),('firth'),('fishy'),('fitly'),('fixer'),('fizzy'),('fjord'),('flack'),('flail'),('flair'),('flake'),('flaky'),('flame'),('flank'),('flare'),('flash'),('flask'),('fleck'),('fleet'),('flesh'),('flick'),('flier'),('fling'),('flint'),('flirt'),('float'),('flock'),('flood'),('floor'),('flora'),('floss'),('flour'),('flout'),('fluff'),('fluid'),('fluke'),('fluky'),('flume'),('flunk'),('flush'),('flute'),('flyby'),('flyer'),('foamy'),('focal'),('focus'),('fogey'),('foggy'),('foist'),('folio'),('folly'),('fondu'),('foray'),('force'),('forge'),('forgo'),('forte'),('forth'),('forty'),('forum'),('found'),('fount'),('foyer'),('frack'),('frail'),('frame'),('franc'),('frank'),('fraud'),('freak'),('fresh'),('friar'),('frier'),('frill'),('frisk'),('fritz'),('frizz'),('frock'),('frond'),('front'),('frosh'),('frost'),('froth'),('frown'),('fruit'),('frump'),('fryer'),('fudge'),('fugal'),('fugue'),('fully'),('funky'),('funny'),('furor'),('furry'),('furze'),('fusee'),('fussy'),('fusty'),('futon'),('fuzzy'),('gabby'),('gable'),('gaffe'),('gaily'),('gamey'),('gamin'),('gamma'),('gamut'),('gassy'),('gator'),('gaudy'),('gauge'),('gaunt'),('gauze'),('gauzy'),('gavel'),('gawky'),('gayly'),('gazer'),('gecko'),('geeky'),('gelid'),('genie'),('genre'),('genus'),('geode'),('getup'),('ghost'),('ghoul'),('giant'),('giddy'),('gimme'),('gimpy'),('gipsy'),('girly'),('girth'),('gismo'),('given'),('giver'),('gizmo'),('glace'),('glade'),('gland'),('glans'),('glare'),('glass'),('glaze'),('gleam'),('glean'),('glide'),('glint'),('glitz'),('gloat'),('globe'),('gloom'),('glory'),('gloss'),('glove'),('gluey'),('gnarl'),('gnash'),('gnome'),('godly'),('gofer'),('going'),('golly'),('gonad'),('goner'),('gonna'),('goods'),('goody'),('gooey'),('goofy'),('goose'),('gorge'),('gorse'),('gotta'),('gouge'),('gourd'),('gouty'),('grace'),('grade'),('graft'),('grain'),('grand'),('grant'),('grape'),('graph'),('grasp'),('grass'),('grate'),('grave'),('gravy'),('graze'),('great'),('grebe'),('greed'),('green'),('greet'),('grief'),('grill'),('grime'),('grimy'),('grind'),('gripe'),('grist'),('grits'),('groan'),('groat'),('groin'),('groom'),('grope'),('gross'),('group'),('grout'),('grove'),('growl'),('gruel'),('gruff'),('grump'),('grunt'),('guano'),('guard'),('guava'),('guess'),('guest'),('guide'),('guild'),('guile'),('guilt'),('guise'),('gulag'),('gulch'),('gully'),('gumbo'),('gummy'),('gunky'),('gunny'),('guppy'),('gushy'),('gussy'),('gusto'),('gusty'),('gutsy'),('gutty'),('gypsy'),('habit'),('hadji'),('haiku'),('hairy'),('hajji'),('halal'),('hallo'),('halve'),('hammy'),('handy'),('hanky'),('haply'),('happy'),('hardy'),('harem'),('harpy'),('harry'),('harsh'),('haste'),('hasty'),('hatch'),('hater'),('haunt'),('haven'),('havoc'),('hazel'),('hazer'),('heady'),('heart'),('heath'),('heave'),('heavy'),('hedge'),('hefty'),('heist'),('helix'),('hello'),('helot'),('helve'),('hence'),('henna'),('heron'),('hertz'),('hewer'),('hider'),('hiker'),('hilly'),('hinge'),('hippo'),('hippy'),('hitch'),('hoagy'),('hoard'),('hoary'),('hobby'),('hogan'),('hoist'),('hokey'),('hokum'),('holey'),('holly'),('homer'),('homey'),('honer'),('honey'),('honky'),('honor'),('hooch'),('hooey'),('hooka'),('hooky'),('horde'),('horny'),('horse'),('horsy'),('hotel'),('hotly'),('hound'),('houri'),('house'),('hovel'),('hover'),('howdy'),('hubby'),('huffy'),('hullo'),('human'),('humid'),('humor'),('humph'),('humus'),('hunch'),('hunky'),('hurry'),('husky'),('hussy'),('hutch'),('huzza'),('hydra'),('hydro'),('hyena'),('hymen'),('hyper'),('icily'),('icing'),('ictus'),('ideal'),('idiom'),('idiot'),('idler'),('idyll'),('igloo'),('ileum'),('ilium'),('image'),('imago'),('imbed'),('imbue'),('impel'),('imply'),('inane'),('inapt'),('inbox'),('incur'),('index'),('indue'),('inept'),('inert'),('infer'),('infra'),('ingot'),('inlay'),('inlet'),('inner'),('input'),('inset'),('inter'),('intro'),('inure'),('ionic'),('irate'),('irony'),('islet'),('issue'),('itchy'),('ivied'),('ivory'),('jabot'),('japan'),('jaunt'),('jazzy'),('jeans'),('jehad'),('jello'),('jelly'),('jenny'),('jerky'),('jetty'),('jewel'),('jiffy'),('jihad'),('jimmy'),('jinni'),('joint'),('joist'),('joker'),('jokey'),('jolly'),('joule'),('joust'),('jowly'),('judge'),('juice'),('juicy'),('julep'),('jumbo'),('jumpy'),('junco'),('junky'),('junta'),('juror'),('kabob'),('kapok'),('kappa'),('kaput'),('karat'),('karma'),('kayak'),('kazoo'),('kebab'),('kebob'),('ketch'),('khaki'),('kicky'),('kiddo'),('kiddy'),('kinda'),('kinky'),('kiosk'),('kitty'),('klutz'),('knack'),('knave'),('knead'),('kneel'),('knell'),('knife'),('knish'),('knock'),('knoll'),('known'),('knurl'),('koala'),('kooky'),('kopek'),('kraal'),('kraut'),('krill'),('krona'),('krone'),('kudos'),('kudzu'),('label'),('labor'),('laden'),('ladle'),('lager'),('laird'),('laity'),('lanai'),('lance'),('lanky'),('lapel'),('lapin'),('lapse'),('larch'),('lardy'),('large'),('largo'),('larva'),('laser'),('lasso'),('latch'),('latex'),('lathe'),('latte'),('laugh'),('laxly'),('layer'),('layup'),('leach'),('leafy'),('leaky'),('learn'),('lease'),('leash'),('least'),('leave'),('ledge'),('leech'),('leery'),('lefty'),('legal'),('leggy'),('legit'),('lemon'),('lemur'),('lento'),('leper'),('letup'),('levee'),('level'),('lever'),('libel'),('licit'),('liege'),('lifer'),('light'),('liken'),('lilac'),('limbo'),('limit'),('linen'),('liner'),('lingo'),('linty'),('lipid'),('lippy'),('lisle'),('liter'),('lithe'),('litre'),('liven'),('liver'),('livid'),('llama'),('llano'),('loamy'),('loath'),('lobar'),('lobby'),('lobed'),('local'),('locus'),('lodge'),('lofty'),('logic'),('login'),('logon'),('loner'),('loony'),('loopy'),('loose'),('loris'),('lorry'),('loser'),('lotto'),('lotus'),('louse'),('lousy'),('lover'),('lower'),('lowly'),('loyal'),('lucid'),('lucky'),('lucre'),('lumpy'),('lunar'),('lunch'),('lunge'),('lupin'),('lupus'),('lurch'),('lurid'),('lusty'),('lying'),('lymph'),('lynch'),('lyric'),('macaw'),('macho'),('macro'),('madam'),('madly'),('mafia'),('magic'),('magma'),('magus'),('maize'),('major'),('maker'),('malty'),('mamba'),('mambo'),('mamma'),('mammy'),('maned'),('manga'),('mange'),('mango'),('mangy'),('mania'),('manic'),('manly'),('manna'),('manor'),('manse'),('manta'),('maple'),('march'),('maria'),('marry'),('marsh'),('maser'),('mason'),('match'),('matte'),('matzo'),('mauve'),('maven'),('mavin'),('maxim'),('maybe'),('mayor'),('mealy'),('meany'),('meaty'),('mecca'),('medal'),('media'),('medic'),('melee'),('melon'),('mercy'),('merge'),('merit'),('merry'),('meson'),('messy'),('metal'),('meter'),('metre'),('metro'),('mezzo'),('micro'),('middy'),('midge'),('midst'),('might'),('milch'),('miler'),('milky'),('mimic'),('mince'),('miner'),('minim'),('minor'),('minty'),('minus'),('mirth'),('misdo'),('miser'),('misty'),('miter'),('mitre'),('mixer'),('mocha'),('modal'),('model'),('modem'),('mogul'),('moire'),('moist'),('molar'),('moldy'),('molly'),('momma'),('mommy'),('money'),('month'),('mooch'),('moody'),('moose'),('moped'),('moper'),('mopey'),('moral'),('moray'),('morel'),('mores'),('moron'),('morph'),('mosey'),('mossy'),('motel'),('motet'),('motif'),('motor'),('motto'),('mould'),('moult'),('mound'),('mount'),('mourn'),('mouse'),('mousy'),('mouth'),('mover'),('movie'),('mower'),('moxie'),('mucky'),('mucus'),('muddy'),('mufti'),('muggy'),('mulch'),('mulct'),('mummy'),('mumps'),('munch'),('mural'),('murky'),('mushy'),('music'),('musky'),('mussy'),('musty'),('mynah'),('myrrh'),('nabob'),('nacho'),('nacre'),('nadir'),('naiad'),('naive'),('naked'),('nanny'),('nappy'),('nasal'),('nasty'),('natal'),('natch'),('natty'),('naval'),('navel'),('neath'),('needy'),('neigh'),('nerdy'),('nerve'),('nervy'),('never'),('nevus'),('newel'),('newly'),('newsy'),('nexus'),('niche'),('niece'),('nifty'),('nigga'),('night'),('ninja'),('ninny'),('ninth'),('nippy'),('nisei'),('niter'),('nitre'),('noble'),('nobly'),('nodal'),('nohow'),('noise'),('noisy'),('nomad'),('nonce'),('noose'),('north'),('nosey'),('notch'),('novel'),('noway'),('nubby'),('nudge'),('nurse'),('nutty'),('nylon'),('nymph'),('oaken'),('oakum'),('oasis'),('oaten'),('obese'),('occur'),('ocean'),('ocher'),('ochre'),('octet'),('oddly'),('odium'),('odour'),('offal'),('offer'),('often'),('ogler'),('okapi'),('olden'),('oldie')
INSERT INTO _tb_wordle_all_words VALUES
('olive'),('omega'),('onion'),('onset'),('opera'),('opine'),('opium'),('optic'),('orate'),('orbit'),('order'),('organ'),('oriel'),('orris'),('osier'),('other'),('otter'),('ought'),('ounce'),('outdo'),('outer'),('outgo'),('outre'),('ovary'),('ovate'),('overt'),('ovoid'),('ovule'),('owlet'),('owner'),('oxbow'),('oxide'),('ozone'),('pacer'),('paddy'),('padre'),('paean'),('pagan'),('pager'),('paint'),('palmy'),('palsy'),('panda'),('panel'),('panic'),('pansy'),('panty'),('papal'),('papaw'),('paper'),('pappy'),('parch'),('parer'),('parka'),('parry'),('parse'),('party'),('pasha'),('passe'),('pasta'),('paste'),('pasty'),('patch'),('patio'),('patsy'),('patty'),('pause'),('payee'),('payer'),('peace'),('peach'),('pearl'),('peaty'),('pecan'),('pedal'),('peeve'),('pekoe'),('penal'),('penis'),('penny'),('peony'),('peppy'),('perch'),('peril'),('perky'),('pesky'),('pesto'),('petal'),('peter'),('petty'),('pewee'),('pewit'),('phase'),('phial'),('phlox'),('phone'),('phony'),('photo'),('piano'),('picky'),('picot'),('piece'),('piety'),('piggy'),('pigmy'),('piker'),('pilaf'),('pilau'),('pilot'),('pinch'),('piney'),('pinko'),('pinky'),('pinon'),('pinto'),('pinup'),('pious'),('piper'),('pipit'),('pique'),('pitch'),('pithy'),('piton'),('pivot'),('pixel'),('pixie'),('pizza'),('place'),('plaid'),('plain'),('plait'),('plane'),('plank'),('plant'),('plash'),('plate'),('platy'),('plaza'),('plead'),('pleat'),('plebe'),('pluck'),('plumb'),('plume'),('plump'),('plumy'),('plunk'),('plush'),('poach'),('poesy'),('point'),('poise'),('poker'),('pokey'),('polar'),('polio'),('polka'),('polyp'),('pooch'),('poppa'),('poppy'),('porch'),('porgy'),('porky'),('porno'),('poser'),('posit'),('posse'),('potty'),('pouch'),('pound'),('power'),('prank'),('prate'),('prawn'),('preen'),('press'),('price'),('prick'),('pricy'),('pride'),('prier'),('prime'),('primp'),('print'),('prior'),('prise'),('prism'),('privy'),('prize'),('probe'),('promo'),('prone'),('prong'),('proof'),('prose'),('prosy'),('proud'),('prove'),('prowl'),('proxy'),('prude'),('prune'),('pryer'),('psalm'),('pshaw'),('psych'),('pubes'),('pubic'),('pubis'),('pudgy'),('puffy'),('pukka'),('pulpy'),('pulse'),('punch'),('pupal'),('pupil'),('puppy'),('puree'),('purge'),('purse'),('pushy'),('pussy'),('putty'),('pygmy'),('pylon'),('quack'),('quaff'),('quail'),('quake'),('quaky'),('qualm'),('quark'),('quart'),('quash'),('quasi'),('queen'),('queer'),('quell'),('query'),('quest'),('queue'),('quick'),('quiet'),('quill'),('quilt'),('quint'),('quire'),('quirk'),('quirt'),('quite'),('quoin'),('quoit'),('quota'),('quote'),('quoth'),('rabbi'),('rabid'),('racer'),('radar'),('radio'),('radon'),('rainy'),('raise'),('rajah'),('rally'),('ramie'),('ranch'),('randy'),('ranee'),('range'),('rangy'),('raper'),('rapid'),('raspy'),('rater'),('ratio'),('ratty'),('ravel'),('raven'),('rayon'),('razor'),('reach'),('react'),('ready'),('realm'),('rearm'),('rebel'),('rebid'),('rebus'),('rebut'),('recap'),('recto'),('recur'),('redye'),('reedy'),('reeve'),('refer'),('refit'),('regal'),('rehab'),('reign'),('relax'),('relay'),('relic'),('remap'),('remit'),('remix'),('renal'),('renew'),('reorg'),('repay'),('repel'),('reply'),('rerun'),('reset'),('resew'),('resin'),('resow'),('retch'),('retie'),('retro'),('retry'),('reuse'),('revel'),('revue'),('rewed'),('rheum'),('rhino'),('rhyme'),('ricer'),('rider'),('ridge'),('ridgy'),('rifle'),('right'),('rigid'),('rigor'),('rinse'),('ripen'),('riser'),('risky'),('ritzy'),('rival'),('river'),('rivet'),('riyal'),('roach'),('roast'),('robin'),('robot'),('rocky'),('rodeo'),('roger'),('rogue'),('roman'),('romeo'),('rondo'),('roomy'),('roost'),('roper'),('rosin'),('rotor'),('rouge'),('rough'),('round'),('rouse'),('roust'),('route'),('rover'),('rowdy'),('rowel'),('rower'),('royal'),('ruble'),('ruddy'),('rugby'),('ruler'),('rumba'),('rummy'),('rumor'),('runic'),('runny'),('runty'),('rupee'),('rural'),('rushy'),('rusty'),('rutty'),('saber'),('sable'),('sabot'),('sabra'),('sabre'),('sadly'),('saggy'),('sahib'),('saint'),('salad'),('sally'),('salon'),('salsa'),('salty'),('salve'),('salvo'),('samba'),('sandy'),('sappy'),('saran'),('saree'),('sarge'),('sassy'),('satay'),('satin'),('satyr'),('sauce'),('saucy'),('sauna'),('saute'),('saver'),('savor'),('savoy'),('savvy'),('scald'),('scale'),('scalp'),('scaly'),('scamp'),('scant'),('scare'),('scarf'),('scarp'),('scary'),('scene'),('scent'),('schmo'),('schwa'),('scion'),('scoff'),('scold'),('scone'),('scoop'),('scoot'),('scope'),('score'),('scorn'),('scour'),('scout'),('scowl'),('scrag'),('scram'),('scrap'),('scree'),('screw'),('scrim'),('scrip'),('scrod'),('scrub'),('scuba'),('scuff'),('scull'),('scurf'),('seamy'),('sedan'),('sedge'),('sedgy'),('seedy'),('segue'),('seine'),('seize'),('semen'),('senna'),('senor'),('sense'),('sepal'),('sepia'),('serge'),('serif'),('serum'),('serve'),('servo'),('setup'),('seven'),('sever'),('sewer'),('shack'),('shade'),('shady'),('shaft'),('shake'),('shaky'),('shale'),('shall'),('shame'),('shank'),('shape'),('shard'),('share'),('shark'),('sharp'),('shave'),('shawl'),('sheaf'),('shear'),('sheen'),('sheep'),('sheer'),('sheet'),('sheik'),('shelf'),('shell'),('sherd'),('shier'),('shift'),('shill'),('shine'),('shiny'),('shire'),('shirk'),('shirr'),('shirt'),('shlep'),('shoal'),('shoat'),('shock'),('shook'),('shoot'),('shore'),('short'),('shout'),('shove'),('showy'),('shred'),('shrew'),('shrub'),('shrug'),('shuck'),('shunt'),('shush'),('shyly'),('sibyl'),('sicko'),('sidle'),('siege'),('sieve'),('sight'),('sigma'),('silky'),('silly'),('silty'),('since'),('sinew'),('singe'),('sinus'),('siree'),('siren'),('sirup'),('sisal'),('sissy'),('sitar'),('situp'),('sixth'),('sixty'),('skate'),('skeet'),('skein'),('skier'),('skiff'),('skill'),('skimp'),('skirt'),('skoal'),('skulk'),('skull'),('skunk'),('slack'),('slake'),('slang'),('slant'),('slash'),('slate'),('slave'),('sleek'),('sleep'),('sleet'),('slice'),('slick'),('slide'),('slily'),('slime'),('slimy'),('sling'),('slink'),('sloop'),('slope'),('slops'),('slosh'),('sloth'),('slump'),('slurp'),('slush'),('slyly'),('smack'),('small'),('smart'),('smash'),('smear'),('smell'),('smelt'),('smile'),('smirk'),('smite'),('smith'),('smock'),('smoke'),('smoky'),('snack'),('snafu'),('snail'),('snake'),('snaky'),('snare'),('snarl'),('sneak'),('sneer'),('snide'),('sniff'),('snipe'),('snips'),('snood'),('snoop'),('snoot'),('snore'),('snort'),('snout'),('snowy'),('snuff'),('soapy'),('sober'),('softy'),('soggy'),('solar'),('solid'),('solve'),('sonar'),('sonic'),('sonny'),('sooth'),('sooty'),('soppy'),('sorry'),('sorta'),('sough'),('sound'),('soupy'),('souse'),('south'),('sower'),('space'),('spacy'),('spade'),('spank'),('spare'),('spark'),('spasm'),('spate'),('spawn'),('speak'),('spear'),('speck'),('specs'),('speed'),('spell'),('spelt'),('spend'),('sperm'),('spice'),('spicy'),('spiel'),('spike'),('spiky'),('spill'),('spine'),('spiny'),('spire'),('spiry'),('spite'),('splat'),('splay'),('split'),('spoil'),('spoke'),('spoof'),('spook'),('spool'),('spoon'),('spoor'),('spore'),('sport'),('spout'),('sprat'),('spray'),('spree'),('sprig'),('spume'),('spumy'),('spunk'),('spurn'),('spurt'),('squab'),('squad'),('squat'),('squaw'),('squib'),('squid'),('stack'),('staff'),('stage'),('stagy'),('staid'),('stain'),('stair'),('stake'),('stale'),('stalk'),('stall'),('stamp'),('stand'),('staph'),('stare'),('stark'),('start'),('stash'),('state'),('stave'),('stead'),('steak'),('steal'),('steam'),('steed'),('steel'),('steep'),('steer'),('stein'),('steno'),('stent'),('stern'),('stick'),('stiff'),('stile'),('still'),('stilt'),('sting'),('stink'),('stint'),('stoat'),('stock'),('stogy'),('stoic'),('stoke'),('stole'),('stomp'),('stone'),('stony'),('stool'),('stoop'),('store'),('stork'),('storm'),('story'),('stoup'),('stout'),('stove'),('strap'),('straw'),('stray'),('strep'),('strew'),('stria'),('strip'),('strop'),('strum'),('strut'),('study'),('stuff'),('stump'),('stunt'),('style'),('stymy'),('suave'),('sudsy'),('suede'),('suety'),('sugar'),('suite'),('sulfa'),('sulky'),('sully'),('sumac'),('sunny'),('sunup'),('super'),('supra'),('surge'),('surly'),('sushi'),('swain'),('swami'),('swamp'),('swank'),('sward'),('swarm'),('swash'),('swath'),('swear'),('sweat'),('swede'),('sweep'),('sweet'),('swell'),('swift'),('swill'),('swine'),('swing'),('swipe'),('swirl'),('swish'),('swoon'),('swoop'),('sword'),('sylph'),('synch'),('synod'),('syrup'),('tabby'),('tabla'),('table'),('taboo'),('tabor'),('tacit'),('tacky'),('taffy'),('taiga'),('taint'),('taker'),('talky'),('tally'),('talon'),('talus'),('tamer'),('tango'),('tangy'),('tansy'),('taper'),('tapir'),('tardy'),('tarot'),('tarry'),('taser'),('taste'),('tasty'),('tater'),('taunt'),('taupe'),('tawny'),('taxer'),('teach'),('teary'),('tease'),('teeny'),('telex'),('telly'),('tempo'),('tempt'),('tenet'),('tenon'),('tenor'),('tense'),('tenth'),('tepee'),('tepid'),('terry'),('terse'),('testy'),('tetra'),('thane'),('thank'),('theft'),('their'),('theme'),('there'),('therm'),('these'),('theta'),('thick'),('thief'),('thigh'),('thine'),('thing')
INSERT INTO _tb_wordle_all_words VALUES
('think'),('third'),('thole'),('thong'),('thorn'),('those'),('three'),('throb'),('throe'),('throw'),('thrum'),('thumb'),('thump'),('thyme'),('tiara'),('tibia'),('tidal'),('tiger'),('tight'),('tilde'),('tiler'),('timer'),('times'),('timid'),('tinge'),('tinny'),('tipsy'),('tired'),('titan'),('tithe'),('title'),('tizzy'),('toady'),('toast'),('today'),('toddy'),('toffy'),('token'),('tonal'),('toner'),('tonic'),('tonne'),('tooth'),('topaz'),('topic'),('toque'),('torah'),('torch'),('torso'),('torte'),('total'),('totem'),('touch'),('tough'),('towel'),('tower'),('toxic'),('toxin'),('trace'),('track'),('tract'),('trade'),('trail'),('train'),('trait'),('tramp'),('trash'),('trawl'),('tread'),('treat'),('trend'),('tress'),('triad'),('trial'),('tribe'),('trice'),('trick'),('trier'),('trike'),('trill'),('tripe'),('trite'),('troll'),('tromp'),('troop'),('trope'),('troth'),('trout'),('trove'),('truce'),('truck'),('truly'),('trump'),('trunk'),('truss'),('trust'),('truth'),('tryst'),('tubal'),('tubby'),('tubed'),('tuber'),('tulip'),('tulle'),('tumid'),('tummy'),('tumor'),('tuner'),('tunic'),('tunny'),('tuque'),('turbo'),('turfy'),('tutor'),('tutti'),('twain'),('twang'),('tweak'),('tweed'),('tween'),('tweet'),('twerk'),('twerp'),('twice'),('twill'),('twine'),('twirl'),('twist'),('twixt'),('udder'),('ukase'),('ulcer'),('ulnar'),('ultra'),('umbel'),('umber'),('umbra'),('umiak'),('unbar'),('unbid'),('uncap'),('uncle'),('uncut'),('under'),('undue'),('unfed'),('unfit'),('unfix'),('unify'),('union'),('unite'),('unity'),('unlit'),('unman'),('unpin'),('unsay'),('untie'),('until'),('unwed'),('unzip'),('upend'),('upper'),('upset'),('urban'),('urine'),('usage'),('usher'),('usual'),('usurp'),('usury'),('utter'),('uvula'),('vague'),('valet'),('valid'),('valor'),('value'),('valve'),('vapid'),('vapor'),('vault'),('vaunt'),('vegan'),('velar'),('veldt'),('velum'),('venal'),('venom'),('venue'),('verge'),('verse'),('verso'),('verve'),('vetch'),('viand'),('vibes'),('vicar'),('video'),('vigil'),('vigor'),('villa'),('vinyl'),('viola'),('viper'),('viral'),('vireo'),('virus'),('visit'),('visor'),('vista'),('vital'),('vivid'),('vixen'),('vizir'),('vizor'),('vocal'),('vodka'),('vogue'),('voice'),('voila'),('voile'),('vomit'),('voter'),('vouch'),('vowel'),('vulva'),('wacko'),('wacky'),('wader'),('wafer'),('wager'),('wagon'),('waist'),('waive'),('waken'),('waltz'),('wanly'),('wanna'),('warty'),('washy'),('waste'),('watch'),('water'),('waver'),('waxen'),('weary'),('weave'),('wedge'),('weedy'),('weeny'),('weepy'),('weigh'),('weird'),('welch'),('welsh'),('wench'),('wetly'),('whack'),('whale'),('wharf'),('wheal'),('wheat'),('wheel'),('whelk'),('whelm'),('whelp'),('where'),('which'),('whiff'),('while'),('whine'),('whiny'),('whirl'),('whirr'),('whisk'),('whist'),('white'),('whizz'),('whole'),('whoop'),('whore'),('whorl'),('whose'),('whoso'),('widen'),('widow'),('width'),('wield'),('wight'),('wilds'),('wimpy'),('wince'),('winch'),('windy'),('wiper'),('wispy'),('witch'),('withe'),('witty'),('woman'),('wonky'),('woods'),('woody'),('wooer'),('wooly'),('woozy'),('wordy'),('works'),('world'),('wormy'),('worry'),('worse'),('worst'),('worth'),('wound'),('wrack'),('wrath'),('wreak'),('wreck'),('wrest'),('wring'),('wrist'),('write'),('wrong'),('wroth'),('wryly'),('wurst'),('wussy'),('xenon'),('xerox'),('xylem'),('yacht'),('yahoo'),('yearn'),('yeast'),('yield'),('yikes'),('yodel'),('yogin'),('yokel'),('young'),('yours'),('youth'),('yucca'),('yucky'),('yummy'),('yuppy'),('zebra'),('zesty'),('zilch'),('zingy'),('zippy'),('zloty'),('zombi'),('zonal')

--final table
CREATE TABLE _tb_wordle_base
(
ID INT IDENTITY(1,1) NOT NULL
,a CHAR NOT NULL
,b CHAR NOT NULL
,c CHAR NOT NULL
,d CHAR NOT NULL
,e CHAR NOT NULL
,final_word VARCHAR(5) NOT NULL
,probability DECIMAL(8,2)
,CONSTRAINT [PK_tb_wordle_base] PRIMARY KEY CLUSTERED (ID)
)
	 
INSERT INTO _tb_wordle_base
SELECT 
	SUBSTRING(word,1,1)
	,SUBSTRING(word,2,1)
	,SUBSTRING(word,3,1)
	,SUBSTRING(word,4,1)
	,SUBSTRING(word,5,1)
	,word
	,NULL
FROM dbo._tb_wordle_all_words

--non-clustered index on word
CREATE NONCLUSTERED INDEX NC__tb_wordle_base__final_word ON _tb_wordle_base(final_word)

--drop unnecessary staging table
DROP TABLE _tb_wordle_all_words

----------------------------------------------------
----history - words already used in the Wordle
----------------------------------------------------

DROP TABLE IF EXISTS _tb_wordle_past_words
DROP TABLE IF EXISTS _tb_wordle_base_hist

--staging - loading source data
CREATE TABLE _tb_wordle_past_words
(
ID INT IDENTITY(1,1) NOT NULL
,past_word VARCHAR(5) NOT NULL
CONSTRAINT [PK_tb_wordle_past_words] PRIMARY KEY CLUSTERED (ID)
)
ON [PRIMARY]
GO

INSERT INTO _tb_wordle_past_words
VALUES
('CIGAR'),('REBUT'),('SISSY'),('HUMPH'),('AWAKE'),('BLUSH'),('FOCAL'),('EVADE'),('NAVAL'),('SERVE'),('HEATH'),('DWARF'),('MODEL'),('KARMA'),('STINK'),('GRADE'),('QUIET'),('BENCH'),('ABATE'),('FEIGN'),('MAJOR'),('DEATH'),('FRESH'),('CRUST'),('STOOL'),('COLON'),('ABASE'),('MARRY'),('REACT'),('BATTY'),('PRIDE'),('FLOSS'),('HELIX'),('CROAK'),('STAFF'),('PAPER'),('UNFED'),('WHELP'),('TRAWL'),('OUTDO'),('ADOBE'),('CRAZY'),('SOWER'),('REPAY'),('DIGIT'),('CRATE'),('CLUCK'),('SPIKE'),('MIMIC'),('POUND'),('MAXIM'),('LINEN'),('UNMET'),('FLESH'),('BOOBY'),('FORTH'),('FIRST'),('STAND'),('BELLY'),('IVORY'),('SEEDY'),('PRINT'),('YEARN'),('DRAIN'),('BRIBE'),('STOUT'),('PANEL'),('CRASS'),('FLUME'),('OFFAL'),('AGREE'),('ERROR'),('SWIRL'),('ARGUE'),('BLEED'),('DELTA'),('FLICK'),('TOTEM'),('WOOER'),('FRONT'),('SHRUB'),('PARRY'),('BIOME'),('LAPEL'),('START'),('GREET'),('GONER'),('GOLEM'),('LUSTY'),('LOOPY'),('ROUND'),('AUDIT'),('LYING'),('GAMMA'),('LABOR'),('ISLET'),('CIVIC'),('FORGE'),('CORNY'),('MOULT'),('BASIC'),('SALAD'),('AGATE'),('SPICY'),('SPRAY'),('ESSAY'),('FJORD'),('SPEND'),('KEBAB'),('GUILD'),('ABACK'),('MOTOR'),('ALONE'),('HATCH'),('HYPER'),('THUMB'),('DOWRY'),('OUGHT'),('BELCH'),('DUTCH'),('PILOT'),('TWEED'),('COMET'),('JAUNT'),('ENEMA'),('STEED'),('ABYSS'),('GROWL'),('FLING'),('DOZEN'),('BOOZY'),('ERODE'),('WORLD'),('GOUGE'),('CLICK'),('BRIAR'),('GREAT'),('ALTAR'),('PULPY'),('BLURT'),('COAST'),('DUCHY'),('GROIN'),('FIXER'),('GROUP'),('ROGUE'),('BADLY'),('SMART'),('PITHY'),('GAUDY'),('CHILL'),('HERON'),('VODKA'),('FINER'),('SURER'),('RADIO'),('ROUGE'),('PERCH'),('RETCH'),('WROTE'),('CLOCK'),('TILDE'),('STORE'),('PROVE'),('BRING'),('SOLVE'),('CHEAT'),('GRIME'),('EXULT'),('USHER'),('EPOCH'),('TRIAD'),('BREAK'),('RHINO'),('VIRAL'),('CONIC'),('MASSE'),('SONIC'),('VITAL'),('TRACE'),('USING'),('PEACH'),('CHAMP'),('BATON'),('BRAKE'),('PLUCK'),('CRAZE'),('GRIPE'),('WEARY'),('PICKY'),('ACUTE'),('FERRY'),('ASIDE'),('TAPIR'),('TROLL'),('UNIFY'),('REBUS'),('BOOST'),('TRUSS'),('SIEGE'),('TIGER'),('BANAL'),('SLUMP'),('CRANK'),('GORGE'),('QUERY'),('DRINK'),('FAVOR'),('ABBEY'),('TANGY'),('PANIC'),('SOLAR'),('SHIRE'),('PROXY'),('POINT'),('ROBOT'),('PRICK'),('WINCE'),('CRIMP'),('KNOLL'),('SUGAR'),('WHACK'),('MOUNT'),('PERKY'),('COULD'),('WRUNG'),('LIGHT'),('THOSE'),('MOIST'),('SHARD'),('PLEAT'),('ALOFT'),('SKILL'),('ELDER'),('FRAME'),('HUMOR'),('PAUSE'),('ULCER'),('ULTRA'),('ROBIN'),('CYNIC'),('AROMA'),('CAULK'),('SHAKE'),('DODGE'),('SWILL'),('TACIT'),('OTHER'),('THORN'),('TROVE'),('BLOKE'),('VIVID'),('SPILL'),('CHANT'),('CHOKE'),('RUPEE'),('NASTY'),('MOURN'),('AHEAD'),('BRINE'),('CLOTH'),('HOARD'),('SWEET'),('MONTH'),('LAPSE'),('WATCH'),('TODAY'),('FOCUS'),('SMELT'),('TEASE'),('CATER'),('MOVIE'),('SAUTE'),('ALLOW'),('RENEW'),('THEIR'),('SLOSH'),('PURGE'),('CHEST'),('DEPOT'),('EPOXY'),('NYMPH'),('FOUND'),('SHALL'),('STOVE'),('LOWLY'),('SNOUT'),('TROPE'),('FEWER'),('SHAWL'),('NATAL'),('COMMA'),('FORAY'),('SCARE'),('STAIR'),('BLACK'),('SQUAD'),('ROYAL'),('CHUNK'),('MINCE'),('SHAME'),('CHEEK'),('AMPLE'),('FLAIR'),('FOYER'),('CARGO'),('OXIDE'),('PLANT'),('OLIVE'),('INERT'),('ASKEW'),('HEIST'),('SHOWN'),('ZESTY'),('TRASH'),('LARVA'),('FORGO'),('STORY'),('HAIRY'),('TRAIN'),('HOMER'),('BADGE'),('MIDST'),('CANNY'),('SHINE'),('GECKO'),('FARCE'),('SLUNG'),('TIPSY'),('METAL'),('YIELD'),('DELVE'),('BEING'),('SCOUR'),('GLASS'),('GAMER'),('SCRAP'),('MONEY'),('HINGE'),('ALBUM'),('VOUCH'),('ASSET'),('TIARA'),('CREPT'),('BAYOU'),('ATOLL'),('MANOR'),('CREAK'),('SHOWY'),('PHASE'),('FROTH'),('DEPTH'),('GLOOM'),('FLOOD'),('TRAIT'),('GIRTH'),('PIETY'),('GOOSE'),('FLOAT'),('DONOR'),('ATONE'),('PRIMO'),('APRON'),('BLOWN'),('CACAO'),('LOSER'),('INPUT'),('GLOAT'),('AWFUL'),('BRINK'),('SMITE'),('BEADY'),('RUSTY'),('RETRO'),('DROLL'),('GAWKY'),('HUTCH'),('PINTO'),('EGRET'),('LILAC'),('SEVER'),('FIELD'),('FLUFF'),('AGAPE'),('VOICE'),('STEAD'),('BERTH'),('MADAM'),('NIGHT'),('BLAND'),('LIVER'),('WEDGE'),('ROOMY'),('WACKY'),('FLOCK'),('ANGRY'),('TRITE'),('APHID'),('TRYST'),('MIDGE'),('POWER'),('ELOPE'),('CINCH'),('MOTTO'),('STOMP'),('UPSET'),('BLUFF'),('CRAMP'),('QUART'),('COYLY'),('YOUTH'),('RHYME'),('BUGGY'),('ALIEN'),('SMEAR'),('UNFIT'),('PATTY'),('CLING'),('GLEAN'),('LABEL'),('HUNKY'),('KHAKI'),('POKER'),('GRUEL'),('TWICE'),('TWANG'),('SHRUG'),('TREAT'),('WASTE'),('MERIT'),('WOVEN'),('NEEDY'),('CLOWN'),('IRONY'),('RUDER'),('GAUZE'),('CHIEF'),('ONSET'),('PRIZE'),('FUNGI'),('CHARM'),('GULLY'),('INTER'),('WHOOP'),('TAUNT'),('LEERY'),('CLASS'),('THEME'),('LOFTY'),('TIBIA'),('BOOZE'),('ALPHA'),('THYME'),('DOUBT'),('PARER'),('CHUTE'),('STICK'),('TRICE'),('ALIKE'),('RECAP'),('SAINT'),('GLORY'),('GRATE'),('ADMIT'),('BRISK'),('SOGGY'),('USURP'),('SCALD'),('SCORN'),('LEAVE'),('TWINE'),('STING'),('BOUGH'),('MARSH'),('SLOTH'),('DANDY'),('VIGOR'),('HOWDY'),('ENJOY'),('VALID'),('IONIC'),('EQUAL'),('FLOOR'),('CATCH'),('SPADE'),('STEIN'),('EXIST'),('QUIRK'),('DENIM'),('GROVE'),('SPIEL'),('MUMMY'),('FAULT'),('FOGGY'),('FLOUT'),('CARRY'),('SNEAK'),('LIBEL'),('WALTZ'),('APTLY'),('PINEY'),('INEPT'),('ALOUD'),('PHOTO'),('DREAM'),('STALE'),('BEGIN'),('SPELL'),('RAINY'),('UNITE'),('MEDAL'),('VALET'),('INANE'),('MAPLE'),('SNARL'),('BAKER'),('THERE'),('GLYPH'),('AVERT'),('BRAVE'),('AXIOM'),('PRIME'),('DRIVE'),('FEAST'),('ITCHY'),('CLEAN'),('HAPPY'),('TEPID'),('UNDUE'),('STUDY'),('EJECT'),('CHAFE'),('TORSO'),('ADORE'),('WOKEN'),('AMBER'),('JOUST'),('INFER'),('BRAID'),('KNOCK'),('NAIVE'),('APPLY'),('SPOKE'),('USUAL'),('RIVAL'),('PROBE'),('CHORD'),('TAPER'),('SLATE'),('THIRD'),('LUNAR'),('EXCEL'),('AORTA'),('POISE'),('EXTRA'),('JUDGE'),('CONDO'),('IMPEL'),('HAVOC'),('MOLAR'),('MANLY'),('WHINE'),('SKIRT'),('ANTIC'),('LAYER'),('SLEEK'),('BELIE'),('LEMON'),('OPERA'),('PIXIE'),('GRIMY'),('SEDAN'),('LEAPT'),('HUMAN'),('KOALA'),('SPIRE'),('FROCK'),('ADOPT'),('CHARD'),('MUCKY'),('ALTER'),('BLURB'),('MATEY'),('ELUDE'),('COUNT'),('MAIZE'),('BEEFY'),('WORRY'),('FLIRT'),('FISHY'),('CRAVE'),('CROSS'),('SCOLD'),('SHIRK'),('TASTY'),('UNLIT'),('DANCE'),('NINTH'),('APPLE'),('FLAIL'),('STAGE'),('HEADY'),('DEBUG'),('GIANT'),('USAGE'),('SOUND'),('SALSA'),('MAGIC'),('CACHE'),('AVAIL'),('KIOSK'),('SWEAT'),('RUDDY'),('RIPER'),('VAGUE'),('ARBOR'),('FIFTY'),('SYRUP'),('WORSE'),('POLKA'),('MOOSE'),('ABOVE'),('SQUAT'),('TREND'),('TOXIC'),('PINKY'),('HORSE'),('REGAL'),('WHERE'),('REVEL'),('EMAIL'),('BIRTH'),('BLAME'),('SURLY'),('SWEEP'),('CIDER'),('MEALY'),('YACHT'),('CREDO'),('GLOVE'),('TOUGH'),('DUVET'),('STAID'),('GROUT'),('VOTER'),('UNTIE'),('GUANO'),('HURRY'),('BESET'),('BREAD'),('EVERY'),('MARCH'),('STOCK')

--final history table
CREATE TABLE _tb_wordle_base_hist
(
ID INT IDENTITY(1,1) NOT NULL
,past_word VARCHAR(5) NOT NULL
,date_word DATE
,CONSTRAINT [PK_tb_wordle_base_hist] PRIMARY KEY CLUSTERED (ID)
)

INSERT INTO _tb_wordle_base_hist
SELECT 
	past_word
	,NULL
FROM [dbo].[past_word]

--add dates where given word was used
;WITH CTE AS
(
SELECT 
	ID
	,past_word
	,ROW_NUMBER() OVER(ORDER BY ID DESC) as rn 
FROM _tb_wordle_base_hist
) 

UPDATE _tb_wordle_base_hist
SET date_word =  DATEADD(day, -rn, '2023-04-03')
FROM _tb_wordle_base_hist wbh
JOIN CTE c ON c.ID = wbh.ID

CREATE NONCLUSTERED INDEX NC__tb_wordle_base_hist__past_word ON _tb_wordle_base_hist(past_word)

DROP TABLE _tb_wordle_past_words
